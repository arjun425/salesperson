{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/redaj/my-next-website/src/app/scan/page.js"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useState, useRef, useEffect } from \"react\";\r\nimport dynamic from \"next/dynamic\";\r\nimport { toast } from \"react-toastify\";\r\nimport { initializeApp } from \"firebase/app\";\r\nimport { getDatabase, ref, set } from \"firebase/database\";\r\n\r\n// Firebase Config - Replace with your details\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyBl2JppV838_TGQ7akVeCi_aubcvrAl9nw\",\r\n  authDomain: \"invenapp-a4191.firebaseapp.com\",\r\n  projectId: \"invenapp-a4191\",\r\n  storageBucket: \"invenapp-a4191.firebasestorage.app\",\r\n  messagingSenderId: \"1061867595172\",\r\n  appId: \"1:1061867595172:web:527ad9b97eff34a621cd31\",\r\n  measurementId: \"G-SJXX8VGJGX\"\r\n};\r\n\r\n// Initialize Firebase\r\nconst app = initializeApp(firebaseConfig);\r\nconst database = getDatabase(app);\r\n\r\n// Dynamically import Quagga for barcode scanning\r\nconst Quagga = dynamic(() => import(\"quagga\").then((module) => module.default || module), { ssr: false });\r\n\r\nexport default function ScanPage() {\r\n  const [useWebcam, setUseWebcam] = useState(false);\r\n  const [scannedCode, setScannedCode] = useState(\"\");\r\n  const [productName, setProductName] = useState(\"\");\r\n  const [scanning, setScanning] = useState(false);\r\n  const [showConfirm, setShowConfirm] = useState(false);\r\n  const videoRef = useRef(null);\r\n\r\n  // Effect: Initialize Quagga when webcam is enabled\r\n  useEffect(() => {\r\n    if (!useWebcam) return;\r\n\r\n    if (!navigator.mediaDevices?.getUserMedia) {\r\n      toast.error(\"getUserMedia is not supported on this browser.\");\r\n      return;\r\n    }\r\n\r\n    import(\"quagga\")\r\n      .then((module) => {\r\n        const QuaggaModule = module.default || module;\r\n        QuaggaModule.init(\r\n          {\r\n            inputStream: {\r\n              name: \"Live\",\r\n              type: \"LiveStream\",\r\n              target: videoRef.current,\r\n              constraints: { width: 640, height: 480, facingMode: \"environment\" },\r\n            },\r\n            decoder: { readers: [\"code_128_reader\", \"ean_reader\", \"ean_8_reader\"] },\r\n          },\r\n          (err) => {\r\n            if (err) {\r\n              console.error(\"Quagga init error:\", err);\r\n              toast.error(\"Error initializing scanner.\");\r\n              return;\r\n            }\r\n            QuaggaModule.start();\r\n          }\r\n        );\r\n\r\n        QuaggaModule.onDetected((result) => {\r\n          const code = result.codeResult.code;\r\n          if (scanning || code === scannedCode) return;\r\n          setScanning(true);\r\n          setScannedCode(code);\r\n          setProductName(\"\"); // Reset product name input\r\n          setShowConfirm(false);\r\n          setTimeout(() => setScanning(false), 3000);\r\n        });\r\n      })\r\n      .catch((error) => {\r\n        console.error(\"Quagga load error:\", error);\r\n        toast.error(\"Failed to load scanner.\");\r\n      });\r\n\r\n    return () => {\r\n      import(\"quagga\").then((module) => {\r\n        const QuaggaModule = module.default || module;\r\n        QuaggaModule.stop();\r\n      });\r\n    };\r\n  }, [useWebcam, scanning, scannedCode]);\r\n\r\n  // Function to save product details in Firebase\r\n  const saveProduct = async () => {\r\n    if (!scannedCode || !productName) {\r\n      toast.error(\"Both barcode and product name are required!\");\r\n      return;\r\n    }\r\n    try {\r\n      const productRef = ref(database, `inventory/${scannedCode}`);\r\n      await set(productRef, { barcode: scannedCode, name: productName });\r\n      toast.success(`Product ${productName} added!`);\r\n      setScannedCode(\"\");\r\n      setProductName(\"\");\r\n      setShowConfirm(false);\r\n    } catch (error) {\r\n      console.error(\"Error saving product:\", error);\r\n      toast.error(\"Failed to save product.\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex flex-col items-center justify-center p-4 bg-gray-50\">\r\n      <h1 className=\"text-3xl font-bold mb-4\">Scan Product</h1>\r\n\r\n      {/* Webcam Toggle */}\r\n      <div className=\"mb-4\">\r\n        <label className=\"mr-2\">Use Webcam:</label>\r\n        <input\r\n          type=\"checkbox\"\r\n          checked={useWebcam}\r\n          onChange={(e) => setUseWebcam(e.target.checked)}\r\n        />\r\n      </div>\r\n\r\n      {/* Webcam Scanning Section */}\r\n      {useWebcam ? (\r\n        <div>\r\n          <div ref={videoRef} className=\"w-80 h-60 bg-black\" />\r\n          <p className=\"mt-2\">Scanned Barcode: <span className=\"font-mono\">{scannedCode}</span></p>\r\n\r\n          {/* Ask for Product Name */}\r\n          {scannedCode && (\r\n            <div className=\"mt-4 flex flex-col\">\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Enter Product Name\"\r\n                value={productName}\r\n                onChange={(e) => setProductName(e.target.value)}\r\n                className=\"p-2 border rounded w-full\"\r\n              />\r\n              <button\r\n                onClick={() => setShowConfirm(true)}\r\n                className=\"mt-2 bg-blue-500 text-white py-2 px-4 rounded\"\r\n              >\r\n                Confirm Product Name\r\n              </button>\r\n            </div>\r\n          )}\r\n\r\n          {/* Confirm & Save Button */}\r\n          {showConfirm && (\r\n            <button\r\n              onClick={saveProduct}\r\n              className=\"mt-2 bg-green-500 text-white py-2 px-4 rounded\"\r\n            >\r\n              Save to Inventory\r\n            </button>\r\n          )}\r\n        </div>\r\n      ) : (\r\n        // Manual Input Mode\r\n        <div className=\"flex flex-col\">\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Enter Barcode\"\r\n            value={scannedCode}\r\n            onChange={(e) => setScannedCode(e.target.value)}\r\n            className=\"p-2 border rounded mb-2\"\r\n          />\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Enter Product Name\"\r\n            value={productName}\r\n            onChange={(e) => setProductName(e.target.value)}\r\n            className=\"p-2 border rounded\"\r\n          />\r\n          <button\r\n            onClick={() => setShowConfirm(true)}\r\n            className=\"mt-2 bg-blue-500 text-white py-2 px-4 rounded\"\r\n          >\r\n            Confirm Product Name\r\n          </button>\r\n          {showConfirm && (\r\n            <button\r\n              onClick={saveProduct}\r\n              className=\"mt-2 bg-green-500 text-white py-2 px-4 rounded\"\r\n            >\r\n              Save to Inventory\r\n            </button>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 316, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}